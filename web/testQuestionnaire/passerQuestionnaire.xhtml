<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:h="http://java.sun.com/jsf/html">

  <body>

    <ui:composition template="./../template.xhtml">

      <ui:define name="metadata">
        <f:metadata>
          <ui:remove>
          <f:viewParam name="idQuestionnaire" value="#{testQuestionnaire.questionnaire}" />
          </ui:remove>
          <f:event type="preRenderView" listener="#{testQuestionnaire.demarrerQcm()}" />
        </f:metadata>
      </ui:define>

      <ui:define name="content">
        <h1>#{testQuestionnaire.testQcm.questionnaire.titre}</h1>
        <h:form>
          <ui:repeat value="#{testQuestionnaire.testQcm.questionnaire.questions}"
                     var="question" varStatus="statut">
            <b>Question #{statut.index + 1} :</b> 
            <br/>
            <h:inputTextarea value="#{question.enonce}" readonly="true" 
                             cols="50" 
                             rows="#{testQuestionnaire.nbLignes(question.enonce, 50)}"
                             />

            <br/>
            <ui:repeat value="#{question.reponses}" var="reponse"
                       varStatus="statut2">
              <h:outputText value="#{statut2.index + 1} -"
                            rendered="#{question.reponses.size() > 1}" 
                            style="vertical-align: top;"/>
              <h:outputText value="&nbsp;&nbsp;&nbps; " rendered="#{question.reponses.size() == 1}" 
                            style="vertical-align: top;"/>
              <h:inputTextarea value="#{reponse.intitule}" readonly="true"
                               cols="50" 
                               rows="#{testQuestionnaire.nbLignes(reponse.intitule, 50)}"/>
              <h:selectBooleanCheckbox value="#{reponse.reponseUtilisateur}"
                                       style="vertical-align: top;"/>
              <h:outputText value="&lt;br/>" rendered="#{! statut2.end}"
                            escape="false"/>
            </ui:repeat>
            <br/><br/>
          </ui:repeat>

          <h:commandButton value="Enregistrer les rÃ©ponses"
                           action="#{testQuestionnaire.terminerQcm()}" />
        </h:form>

      </ui:define>

    </ui:composition>

  </body>
</html>
